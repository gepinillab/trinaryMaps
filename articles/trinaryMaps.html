<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Trinary Maps Vignette • trinaryMaps</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Trinary Maps Vignette">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">trinaryMaps</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/trinaryMaps.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Trinary Maps Vignette</h1>
                        <h4 data-toc-skip class="author">Cory Merow and
Gonzalo E. Pinilla-Buitrago</h4>
            
            <h4 data-toc-skip class="date">2014-08-31</h4>
      

      <div class="d-none name"><code>trinaryMaps.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>Continuous model predictions are compared against binary data for
evaluation in a variety of application; I’m thinking about Species
Distribution Models (SDMs) but the following could be probably be used
for any application. To evaluate the continuous predictions of the model
- in the SDM case the ‘suitability’ scores - one must choose a threshold
value of suitability above which the model predicts a species presence
and below which the model predicts absence. Coming up with a reasonable
threshold is difficult for SDMs, particularly when presence-backround
data are involved. Use of the AUC statistic is meant to avoid the issues
of choosing a particular threshold and evaluate model performance over
all possible thresholds. Even still, in SDM applications, there is still
often a need for generating a binary map from continuous predictions,
which means picking a threshold.</p>
<p>The specific problem of choosing a threshold when using
presence-background data for SDMs is that the background is
‘contaminated’ - it contains (unknown) presences that biases binary
classification statistics. One common threshold choice is based on
maximizing the sum of sensitivity and specificity (i.e., the Youden
threshold), but this penalizes a model for incorrectly predicting
background points as presence locations, when in fact they may be
presences.The contribution of ‘trinaryMaps’ is to put some useful bounds
on what reasonable values of the threshold might be. If we can’t
determine an optimal threshold, we can at least identify upper and lower
limits so we know we have it surrounded.</p>
<p>The approach to identifying these limits is heuristic and not based
on any formal theory; rather it is based on analyzing the ROC curve and
identifying limits beyond which model predictions aren’t likely to be
very useful in the application of SDMs. For example, why would any care
about the discrimination of an SDM based on a threshold that gets only
7% of presences correct? This implies there should be a upper limit on a
useful threshold (higher threshold implies fewer predicted presences).
Similarly, why would anyone want a model that predicts that only 4% of
the background is an absence? If your model were that
non-discriminating, why even build a model when you could just use the
modeling domain as a range estimate? So this suggests there is a useful
lower limit (lower threshold implies more predicted presences). How can
we objectively find these upper and lower limits? Answering that is the
contribution of trinaryMaps.</p>
</div>
<div class="section level2">
<h2 id="using-trinary-maps">Using Trinary Maps<a class="anchor" aria-label="anchor" href="#using-trinary-maps"></a>
</h2>
<p>Building trinary maps involves the same inputs as one would use for
binary classification and in this package is specifically structured for
use with SDMs: 1. Model prediction (spatRaster) 2. Occurrences
coordinates (data.frame) 3. Background coordinates (data.frame)</p>
</div>
<div class="section level2">
<h2 id="basic-workflow">Basic Workflow<a class="anchor" aria-label="anchor" href="#basic-workflow"></a>
</h2>
<p>The <code><a href="../reference/trinaryMapWorkflow.html">trinaryMapWorkflow()</a></code> function is the main entry
point for using the package. It performs the following steps: 1.
Calculates upper and lower ROC bounds 2. Creates a trinary map based on
these bounds 3. Calculates range sizes associated with the generated
trinary map Plots the ROC curve with upper and lower ROC bounds.</p>
<p>Here’s an example of how to use the trinaryMapWorkflow function:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gepinillab.github.io/trinaryMaps/">trinaryMaps</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## terra 1.7.78</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># YOU CAN REGENERATE THE OCCURRENCE, BACKGROUND AND RASTER PREDICTION OF </span></span>
<span><span class="co"># THIS EXAMPLE USING THE CODE AT THE END OF THIS VIGNETTE</span></span>
<span><span class="va">ext_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">'trinaryMaps'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">occs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">ext_data</span>, <span class="st">"/occs.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">ext_data</span>, <span class="st">"/bg.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">ext_data</span>, <span class="st">"/prediction.tif"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Run trinaryMapWorkflow</span></span>
<span><span class="va">tr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trinaryMapWorkflow.html">trinaryMapWorkflow</a></span><span class="op">(</span>pres <span class="op">=</span> <span class="va">occs</span>, </span>
<span>                         background <span class="op">=</span> <span class="va">bg</span>, </span>
<span>                         rModel <span class="op">=</span> <span class="va">r</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 94 presences and 9681 background points used for building trinary maps</span></span></code></pre>
<div class="section level3">
<h3 id="plotting-the-trinary-map">Plotting the Trinary Map<a class="anchor" aria-label="anchor" href="#plotting-the-trinary-map"></a>
</h3>
<p>The trinary map is a categorical map that has been transformed into
three classes based on the upper and lower bounds calculated by the
<code><a href="../reference/trinaryMapWorkflow.html">trinaryMapWorkflow()</a></code> function. This plot provides a visual
representation of where the three classes occur. Class 0 corresponds to
pixels with values below the higher ROC bound threshold (definitely
unoccupied habitat), class 1 correspond to pixels greater or equal to
the upper ROC bound threshold but less than the lower ROC bound
threshold (marginal, occasional, or uncertain occupied habitat), and
class 2 denotes pixels with values above the lower ROC bound threshold
(likely occupied habitat).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tr</span><span class="op">$</span><span class="va">trinary.rasters</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">occs</span><span class="op">)</span></span></code></pre></div>
<p><img src="trinaryMaps_files/figure-html/plot_raster-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="range-size">Range Size<a class="anchor" aria-label="anchor" href="#range-size"></a>
</h3>
<p>This chunk calculates the range sizes associated with each threshold
value in the trinary map. The range size is an important metric that can
be used to understand the sensitivity and specificity of the model
predictions at different threshold values.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Area</span></span>
<span><span class="fu"><a href="../reference/trinaryRangeSize.html">trinaryRangeSize</a></span><span class="op">(</span><span class="va">tr</span><span class="op">$</span><span class="va">trinary.rasters</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   range.size.lo.km2 range.size.hi.km2</span></span>
<span><span class="co">## 1          13413279           3385016</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="trinary-map-roc-plots">Trinary Map ROC Plots<a class="anchor" aria-label="anchor" href="#trinary-map-roc-plots"></a>
</h3>
<p>The function <code><a href="../reference/trinaryROCPlot.html">trinaryROCPlot()</a></code> generates five ROC plots
that help determine the lower and upper bound thresholds. These plots
facilitate understanding of how the trinary map is constructed.</p>
<div class="section level4">
<h4 id="roc">ROC<a class="anchor" aria-label="anchor" href="#roc"></a>
</h4>
<p>This plot shows the smoothed ROC curve by binormal or density
smoothing. The red dot marks the location of the <strong>lower ROC bound
threshold</strong>, which represents the minimum sensitivity and maximum
specificity value. The yellow dot indicates the <strong>youden
threshold</strong>, corresponding to the maximum sum of sensitivity and
specificity values. The blue dot marks the <strong>upper ROC bound
threshold</strong>, which represents the maximum sensitivity and the
minimum value on specificity.</p>
</div>
<div class="section level4">
<h4 id="roc-first-derivative">ROC’: First Derivative<a class="anchor" aria-label="anchor" href="#roc-first-derivative"></a>
</h4>
<p>The first derivative of the smoothed ROC curve is shown here. This
plot helps identify the point on the ROC curve where the trade-off
between true positive rates and false positive rates is optimized. Note
that the <strong>youden threshold</strong> corresponds to the root.</p>
</div>
<div class="section level4">
<h4 id="logmodroc-logmod-of-second-derivative">logmod(ROC’’): Logmod of Second Derivative<a class="anchor" aria-label="anchor" href="#logmodroc-logmod-of-second-derivative"></a>
</h4>
<p>This plot displays the second derivative of the smoothed ROC curve
after applying a logmod transformation. It helps to identify the
<strong>upper ROC bound threshold</strong> (blue).</p>
</div>
<div class="section level4">
<h4 id="inverted-roc">Inverted ROC<a class="anchor" aria-label="anchor" href="#inverted-roc"></a>
</h4>
<p>To calculate the upper bound threshold, the horizontal and vertical
axes are inverted in this plot. This results in an “inverted ROC” curve
where high specificity values correspond to low true positive rates, and
vice versa.</p>
</div>
<div class="section level4">
<h4 id="logmodinverted-roc">logmod(Inverted ROC)<a class="anchor" aria-label="anchor" href="#logmodinverted-roc"></a>
</h4>
<p>The second derivative of the inverted ROC curve is calculated after
applying a logmod transformation. The red dot marks the <strong>lower
ROC bound threshold</strong>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trinaryROCPlot.html">trinaryROCPlot</a></span><span class="op">(</span><span class="va">tr</span><span class="op">$</span><span class="va">threshs</span><span class="op">$</span><span class="va">plotThings</span>, trinaryDF <span class="op">=</span> <span class="va">tr</span><span class="op">$</span><span class="va">threshs</span><span class="op">$</span><span class="va">trinaryDF</span><span class="op">)</span></span></code></pre></div>
<p><img src="trinaryMaps_files/figure-html/ROCplots-1.png" width="700"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="custom-example-trinaryrocroots-gepb-needs-to-ask-cm">Custom example (trinaryROCRoots)** (GEPB needs to ask CM)<a class="anchor" aria-label="anchor" href="#custom-example-trinaryrocroots-gepb-needs-to-ask-cm"></a>
</h2>
<p>The <code><a href="../reference/trinaryMapWorkflow.html">trinaryMapWorkflow()</a></code> function calculates the upper
and lower ROC bounds using default parameters. If you want to customize
the calculation of both bounds, you can modify the following
parameters:</p>
<ul>
<li><p><code>maxTPQuantile</code>: A quantile value representing the
predicted values at presence locations used to determine the upper ROC
threshold for presence predictions. For example, a value of
<code>0.3</code> means the function uses the 30th percentile of the
predicted presence values as the upper threshold, ensuring that the
model maintains at least 70% sensitivity.</p></li>
<li><p><code>sdMultiplier</code>: A scaling factor applied to the
standard deviation of the predictions, used inconjunction with max.sens
to calculate the lower ROC bound.</p></li>
<li><p><code>max.sens</code>: The maximum true positive rate allowed for
the lower ROC bound calculation. This parameter is used in combination
with sdMultiplier to determine the optimal threshold for the lower
bound.</p></li>
</ul>
<p>Here, we will modified the maximum quantile to 20th percentile, and
change the maximum sensitivity allowed for the lower ROC bound to
0.99.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Issues with maxTPQuantile, max.sens, and sdMultiplier. Results are the same that previus example.</span></span>
<span><span class="va">tr2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trinaryMapWorkflow.html">trinaryMapWorkflow</a></span><span class="op">(</span>pres <span class="op">=</span> <span class="va">occs</span>, </span>
<span>                          background <span class="op">=</span> <span class="va">bg</span>, </span>
<span>                          rModel <span class="op">=</span> <span class="va">r</span>, </span>
<span>                          maxTPQuantile <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                          max.sens <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 94 presences and 9681 background points used for building trinary maps</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tr2</span><span class="op">$</span><span class="va">trinary.rasters</span><span class="op">)</span></span></code></pre></div>
<p><img src="trinaryMaps_files/figure-html/ROCroots-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trinaryROCPlot.html">trinaryROCPlot</a></span><span class="op">(</span><span class="va">tr2</span><span class="op">$</span><span class="va">threshs</span><span class="op">$</span><span class="va">plotThings</span>, trinaryDF <span class="op">=</span> <span class="va">tr2</span><span class="op">$</span><span class="va">threshs</span><span class="op">$</span><span class="va">trinaryDF</span><span class="op">)</span></span></code></pre></div>
<p><img src="trinaryMaps_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<div class="section level3">
<h3 id="additional-code">Additional Code<a class="anchor" aria-label="anchor" href="#additional-code"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/sdm/" class="external-link">predicts</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mrmaxent/maxnet" class="external-link">maxnet</a></span><span class="op">)</span></span>
<span><span class="co"># Load example data</span></span>
<span><span class="va">occurence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"/ex/bradypus.csv"</span>, package <span class="op">=</span> <span class="st">"predicts"</span><span class="op">)</span></span>
<span><span class="va">occ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">occurence</span><span class="op">)</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"ex/bio.tif"</span>, package <span class="op">=</span> <span class="st">"predicts"</span><span class="op">)</span></span>
<span><span class="va">envs</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Prepare data for modeling</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">envs</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">ID</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">envs</span><span class="op">)</span> <span class="op">*</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">envs</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">occs.p</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/extract.html" class="external-link">extract</a></span><span class="op">(</span><span class="va">envs</span>, <span class="va">occ</span>, cells <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">ncell</a></span><span class="op">(</span><span class="va">envs</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">p</span><span class="op">[</span><span class="va">occs.p</span><span class="op">$</span><span class="va">cell</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/xyCellFrom.html" class="external-link">xFromCell</a></span><span class="op">(</span><span class="va">envs</span>, <span class="fl">1</span><span class="op">:</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">ncell</a></span><span class="op">(</span><span class="va">envs</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/xyCellFrom.html" class="external-link">yFromCell</a></span><span class="op">(</span><span class="va">envs</span>, <span class="fl">1</span><span class="op">:</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">ncell</a></span><span class="op">(</span><span class="va">envs</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/na.omit.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build and predict model</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">maxnet</span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">p</span>, <span class="va">data</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">p.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mod</span>, <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">envs</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"cloglog"</span><span class="op">)</span></span>
<span><span class="va">suitability</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">ncell</a></span><span class="op">(</span><span class="va">envs</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">suitability</span><span class="op">[</span><span class="va">data</span><span class="op">$</span><span class="va">ID</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">p.vals</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="va">envs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"suitability"</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">suitability</span></span>
<span><span class="va">occs</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="va">data</span><span class="op">$</span><span class="va">p</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">bg</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="va">data</span><span class="op">$</span><span class="va">p</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cory Merow, Gonzalo E. Pinilla-Buitrago.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
